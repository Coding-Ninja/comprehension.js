<!DOCTYPE html>
<html lang="en">
  <head>
		<title>List Comprehension</title>
		<style type="text/css">
		body{font-family:sans-serif;}
		</style>
	</head>
	<body>
		<h1>List Comprehension</h1>
		
		<script type="text/javascript">		
		var test1 = s("{ x | x <- [1,2,3,4,5,6,7] | x }");
		var test2 = s("{ x*x | x <- [1,2,3,4,5,7] | x }");
		var test3 = s("{ x | x <- [1,2,3,4,5,6,7] | x > 1 && x !=3 }");
		
		console.log(test1);
		console.log(test2);
		console.log(test3);
	
		function s(c)
		{
			trans = "__SOURCE__.filter(function(x){return (__PREDICATE__);}).map(function(x){return __TRANSFORM__;})";
			var tokens = c.split("|");
			if(tokens.length == 3)
			{
				var source = tokens[1].replace("x","").replace("<-","").trim();
				var transform = tokens[0].replace("{","").trim();
				var predicate = tokens[2].replace("}","").trim();
				
				return eval(trans.replace("__SOURCE__",source).replace("__TRANSFORM__",transform).replace("__PREDICATE__",predicate));
			}
			return "error";
		}
		//==============================
		// utils
		//==============================
		function j(x){return document.getElementById(x);}
		</script>
	</body>
</html>
